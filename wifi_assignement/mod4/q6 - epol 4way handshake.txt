The EAPOL 4-Way Handshake (used in wifi networks with WPA/WPA2/WPA3 security) is a process that ensures both the client (supplicant) and the access point (authenticator) can securely generate and agree on encryption keys for a session. Itâ€™s part of the IEEE 802.11i (WPA2) standard.



PMK (Pairwise Master Key): The base key known to both client and access point ( derived from PSK)

PTK (Pairwise Transient Key): A session key derived during the handshake from PMK + nonces + MAC addresses

ANonce: A random number generated by the Access Point.

SNonce: A random number generated by the Supplicant (client).

GTK (Group Temporal Key): Used for broadcast and multicast traffic.



=> Message 1: AP -> Client
AP sends ANonce to the client, used along with SNonce to derive the PTK,also ensures that the AP is active and ready to proceed.



=> Message 2: Client -> AP
Client responds with SNonce,It also includes a MIC (Message Integrity Code) calculated using the derived PTK, The client now has both nonces and can derive the PTK.
MIC proves to the AP that the client has the correct PMK (mutual authentication).


=> Message 3: AP -> Client
AP sends Group Key (GTK) encrypted with the PTK, it includes another MIC to confirm it knows the PTK.GTK allows the client to receive broadcast/multicast traffic.
MIC confirms PTK validity.

=> Message 4: Client -> AP
Client sends an acknowledgment,Confirms GTK was received and finalizes the handshake.

importance

PMK	The base shared secret. Must be known by both sides.
PTK	The session key used for unicast traffic. Derived from PMK + ANonce + SNonce + MACs.
GTK	Used by all clients for broadcast/multicast traffic. Shared securely in step 3.
ANonce / SNonce	Randomness to ensure PTK uniqueness. Prevents replay attacks.
MIC	Ensures integrity of messages. Verifies both sides derived the same PTK.